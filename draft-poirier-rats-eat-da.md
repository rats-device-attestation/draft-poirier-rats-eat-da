---
title: "SPDM EAT Profile for Device Attestation"
abbrev: "EAT DA"
category: info

docname: draft-poirier-rats-eat-da-latest
submissiontype: independent
number:
date:
consensus: false
v: 3
area: AREA
workgroup: WG Working Group
keyword:
 - attestation
 - device assignment
 - EAT
venue:
  group: WG
  type: Working Group
  mail: WG@example.com
  arch: https://example.com/WG
  github: USER/REPO
  latest: https://example.com/LATEST

author:
 -
    fullname: Mathieu Poirier
    organization: Linaro
    email: mathieu.poirier@linaro.org
 -
    fullname: Thomas Fossati
    organization: Linaro
    email: thomas.fossati@linaro.org

normative:
  RFC9711: rats-eat

informative:

--- abstract

In confidential computing, device assignment (DA) is the method by which a device (e.g., network adapter, GPU), whether on-chip or behind a PCIe Root Port, is assigned to a Trusted Virtual Machine (TVM).

For the TVM to trust the device, the device must provide the TVM with attestation Evidence confirming its identity and the state of its firmware and configuration. SPDM complient devices are expected to present attestation Evidence that is within the boundaries of the SPDM protocol, regardless of architecture or execution context.  As such, this document proposes a common represetation for attestation Evidence generated by devices that support the SPDM protocol.  Out of concern for interoperability and to leverage existing attestation standards, this common representation is expressed as an EAT (Entity Attestation Token) profile.

--- middle

# Introduction

In confidential computing, device assignment (DA) is the method by which a device (e.g., network adapter, GPU), whether on-chip or behind a PCIe Root Port, is assigned to a Trusted Virtual Machine (TVM).
Most confidential computing platforms (e.g., Arm CCA, AMD SEV-SNP, Intel TDX) provide DA capabilities.
Such capabilities prevent agents which are untrusted by the TVM (including other TVMs and the host hypervisor) from accessing or controlling a device that has been assigned to the TVM.
This includes, for example, protection of device MMIO interfaces and device caches.
From a trust perspective, DA allows a device to be included in the TVM's Trusted Computing Base (TCB).
For the TVM to trust the device, the device must provide the TVM with attestation Evidence confirming its identity and the state of its firmware and configuration.

This document defines an attestation Evidence format for DA as an EAT {{-rats-eat}} profile with focus on devices that support the SPDM protocol.  SPDM compliant devices expose attestation information that fits within the framework of the protocol, regardless of CPU architecture or execution environment.  To ensure interoperability between platforms, vendors and applications, we propose a format that standardizes the attestation information presented by the SPDM protocol in an EAT profile that can be embedded in a broader platform attestation token.  Interoperability concerts are addressed by formalizing the syntax and connotation of the claims described by the SPDM attestation token.

# Conventions and Definitions

{::boilerplate bcp14-tagged}

# SPDM Claims

~~~ cddl
{::include-fold cddl/spdm-claims.cddl}
~~~

## Measurement Claims

~~~ cddl
{::include-fold cddl/spdm-measurement.cddl}
~~~

## Measurement Claims Signature

~~~ cddl
{::include-fold cddl/spdm-measurement-blocks-signature.cddl}
~~~

## Certificate Claims

~~~ cddl
{::include-fold cddl/spdm-certificates.cddl}
~~~

# Device Attestation Claims

~~~ cddl
{::include-fold cddl/da-token.cddl}
~~~


# Collated CDDL

~~~ cddl
{::include-fold cddl/da-token-autogen.cddl}
~~~

# Security Considerations

TODO Security

# IANA Considerations

## New CWT Claims Registrations

TODO IANA CWT allocations

## New CBOR Tags Registrations

TODO IANA CBOR Tag allocations

--- back

# Examples

~~~ cbor-diag
{::include-fold cddl/examples/1.diag}
~~~

# Acknowledgments
{:numbered="false"}

TODO acknowledge.
